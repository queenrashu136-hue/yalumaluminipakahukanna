<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ğŸ€ ğğ”ğ„ğ„ğ ğ‘ğ€ğ’ğ‡ğ” ğŒğˆğğˆ ğŸ€</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

:root{
--bg1:#ff7ac8;
--bg2:#14000f;
--box:rgba(255,182,193,0.18);
--text:#fff;
--accent:#ff69b4;
}

body.dark{
--bg1:#000;
--bg2:#000;
--box:rgba(255,255,255,0.08);
--text:#fff;
--accent:#00ffff;
}

body{
margin:0;
height:100vh;
font-family:Poppins,sans-serif;
background:radial-gradient(circle at top,var(--bg1),var(--bg2) 65%);
display:flex;
justify-content:center;
align-items:center;
overflow:hidden;
color:var(--text);
}

/* ===== WELCOME POPUP ===== */
.welcome-overlay{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
backdrop-filter:blur(8px);
display:flex;
justify-content:center;
align-items:center;
z-index:9999;
animation:fadeIn .6s;
}

@keyframes fadeIn{
from{opacity:0}
to{opacity:1}
}

.welcome-box{
width:320px;
padding:25px;
border-radius:25px;
background:var(--box);
text-align:center;
box-shadow:0 0 35px var(--accent);
animation:pop .6s;
}

@keyframes pop{
from{transform:scale(.8)}
to{transform:scale(1)}
}

.welcome-box h2{
margin:10px 0;
text-shadow:0 0 12px var(--accent);
}

.follow-btn{
display:block;
margin:15px 0;
padding:12px;
border-radius:30px;
background:linear-gradient(135deg,#ff69b4,#ff1493);
color:#fff;
font-weight:bold;
text-decoration:none;
box-shadow:0 0 15px var(--accent);
}

.skip-btn{
margin-top:10px;
background:none;
border:none;
color:#fff;
cursor:pointer;
opacity:.8;
}

#mandatory-warning{
margin-top:10px;
color:transparent;
-webkit-text-stroke:1px #ff69b4;
font-weight:bold;
font-size:0.9rem;
display:none;
}

/* shake animation */
@keyframes shake{
  0%{transform:translateX(0)}
  25%{transform:translateX(-5px)}
  50%{transform:translateX(5px)}
  75%{transform:translateX(-5px)}
  100%{transform:translateX(0)}
}

/* follow count */
#follow-count{
margin-top:10px;
color:#ff69b4;
font-weight:bold;
}

/* ===== MAIN BOX ===== */
.box{
width:340px;
padding:25px;
border-radius:22px;
background:var(--box);
backdrop-filter:blur(18px);
text-align:center;
box-shadow:0 0 35px var(--accent);
animation:glow 3s infinite alternate;
}
@keyframes glow{
from{box-shadow:0 0 20px var(--accent)}
to{box-shadow:0 0 45px var(--accent)}
}

.fa-user{
font-size:3rem;
color:var(--accent);
text-shadow:0 0 15px var(--accent);
animation:bounce 2s infinite;
}
@keyframes bounce{50%{transform:translateY(-8px)}}

.input-container{
margin-top:20px;
display:flex;
border-radius:30px;
overflow:hidden;
background:#fff;
box-shadow:0 0 15px var(--accent);
}
.input-container input{
width:70%;
border:none;
padding-left:1rem;
font-size:1rem;
outline:none
}
.input-container button{
width:30%;
border:none;
cursor:pointer;
background:linear-gradient(135deg,#ff69b4,#ff1493);
color:#fff;
font-weight:bold
}

.loader{
display:none;
margin:15px auto;
width:40px;height:40px;
border:4px solid #fff;
border-top:4px solid var(--accent);
border-radius:50%;
animation:spin 1s linear infinite
}
@keyframes spin{to{transform:rotate(360deg)}}

.toast{
position:fixed;
bottom:20px;
left:50%;
transform:translateX(-50%);
background:#000;
color:#fff;
padding:10px 20px;
border-radius:20px;
display:none;
box-shadow:0 0 15px var(--accent)
}

.theme{
position:fixed;
top:15px;
right:15px;
background:var(--accent);
color:#000;
border:none;
padding:8px 12px;
border-radius:20px;
cursor:pointer;
font-weight:bold
}
</style>
</head>
<body>

<!-- ğŸŒ¸ WELCOME POPUP -->
<div class="welcome-overlay" id="welcome">
  <div class="welcome-box">
    <i class="fas fa-heart" style="font-size:2.5rem;color:var(--accent)"></i>
    <h2>Welcome ğŸ’–</h2>
    <p>Follow our WhatsApp Channel to continue</p>

    <a class="follow-btn" 
       href="https://whatsapp.com/channel/0029Vb7RfVJ0AgWJdoW3Z12f" 
       target="_blank"
       onclick="followChannel()">
       ğŸ‘‰ Follow Channel
    </a>

    <button class="skip-btn" onclick="showMandatoryWarning()">Skip</button>
    
    <p id="mandatory-warning">âš  You must follow the channel to continue!
    à¶ à·à¶±à¶½à·Š à¶‘à¶š Fallow à¶šà¶»à·œà¶­à·Š à·€à·’à¶­à¶»à¶ºà·’ à·€à·à¶© à¶šà¶»à¶±à·Šà¶±à·™ğŸ’®</p>
    <p id="follow-count">Followed: 0</p>
  </div>
</div>

<button class="theme" onclick="toggleTheme()">ğŸŒ™ / ğŸ€</button>

<div class="box">
<i class="fa fa-user"></i>
<h3>ğŸ€ ğğ”ğ„ğ„ğ ğ‘ğ€ğ’ğ‡ğ” ğŒğˆğğˆ ğŸ€</h3>
<h6>Oá´¡É´á´‡Ê€ BÊ NÉªá´˜á´œÉ´ Há´€Ê€êœ±Êœá´€É´á´€</h6>
<h6>ğŸ”¢ Enter your number with country code</h6>

<div class="input-container">
<input placeholder="9476xxxxxxx" type="number" id="number">
<button id="submit">Submit</button>
</div>

<div class="loader" id="loader"></div>
<main id="pair"></main>
</div>

<div class="toast" id="toast"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.0.0-alpha.1/axios.min.js"></script>
<script>
let a=document.getElementById("pair");
let b=document.getElementById("submit");
let c=document.getElementById("number");
let l=document.getElementById("loader");
let t=document.getElementById("toast");

// ===== Welcome Popup Functions =====
async function getFollowCount(){
  try{
    const res = await fetch('/api/follow-count');
    const data = await res.json();
    document.getElementById('follow-count').innerText = `Followed: ${data.count}`;
  }catch(e){
    console.log(e);
    document.getElementById('follow-count').innerText = `Followed: ?`;
  }
}

async function followChannel(){
  try{
    await fetch('/api/increment-follow',{method:'POST'});
    await getFollowCount();
    closeWelcome();
  }catch(e){
    console.log(e);
    closeWelcome();
  }
}

function closeWelcome(){
  document.getElementById("welcome").style.display="none";
}

function showMandatoryWarning(){
  const w = document.getElementById("mandatory-warning");
  w.style.display="block";
  w.style.color="transparent";
  w.style.animation = "shake 0.5s";
  setTimeout(()=> w.style.animation="",500);
}

// ===== Other Functions =====
function showToast(msg){
t.innerText=msg;
t.style.display="block";
setTimeout(()=>t.style.display="none",2000);
}

function toggleTheme(){
document.body.classList.toggle("dark");
}

async function Copy(){
let obj=document.getElementById("copy");
await navigator.clipboard.writeText(obj.innerText.replace('CODE: ',''));
showToast("Copied Successfully ğŸ’–");
}

b.addEventListener("click",async(e)=>{
e.preventDefault();
if(!c.value){showToast("Enter Number");return}
l.style.display="block";
a.innerHTML="";
const number=c.value.replace(/[^0-9]/g,"");
let {data}=await axios(`/code?number=${number}`);
l.style.display="none";
let code=data.code||"Service Unavailable";
a.innerHTML=`<font id="copy" onclick="Copy()" style="color:red;font-weight:bold" size="5">CODE: <span style="color:white;">${code}</span></font>`;
});

// Load follow count on page load
window.onload = getFollowCount;
</script>
</body>
</html>